<div class="glass-card">
    <div class="section-header">
        <span>📋</span> 정보 입력
    </div>

    <form id="input-form" method="POST" action="/api/calculate">
        <div style="margin-bottom: 1rem;">
            <label for="name" style="display: block; margin-bottom: 0.5rem; color: var(--text-primary);">성함</label>
            <input type="text" id="name" name="name" placeholder="성함을 입력해주세요" value="{{ user_name }}" required
                autocomplete="off"
                style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-gold); border-radius: 8px; background: var(--navy-glass); color: var(--text-primary);">
        </div>

        <div style="margin-bottom: 1rem;">
            <label for="birth_date"
                style="display: block; margin-bottom: 0.5rem; color: var(--text-primary);">생년월일</label>
            <input type="date" id="birth_date" name="birth_date" min="1900-01-01" required value="{{ birth_date }}"
                style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-gold); border-radius: 8px; background: var(--navy-glass); color: var(--text-primary);">
        </div>

        <div style="margin-bottom: 1rem;">
            <label for="birth_time" style="display: block; margin-bottom: 0.5rem; color: var(--text-primary);">태어난 시각
                (선택사항)</label>
            <input type="time" id="birth_time" name="birth_time" value="{{ birth_time }}"
                style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-gold); border-radius: 8px; background: var(--navy-glass); color: var(--text-primary);">
        </div>

        <div style="margin-bottom: 1rem;">
            <label for="gender" style="display: block; margin-bottom: 0.5rem; color: var(--text-primary);">성별</label>
            <select id="gender" name="gender" required
                style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-gold); border-radius: 8px; background: var(--navy-glass); color: var(--text-primary);">
                <option value="">선택해주세요</option>
                <option value="남성" {% if user_gender=='남성' %}selected{% endif %}>남성</option>
                <option value="여성" {% if user_gender=='여성' %}selected{% endif %}>여성</option>
                <option value="기타" {% if user_gender=='기타' %}selected{% endif %}>기타</option>
            </select>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label style="display: flex; align-items: center; color: var(--text-primary);">
                <input type="checkbox" id="is_lunar" name="is_lunar" style="margin-right: 0.5rem;" {% if is_lunar
                    %}checked{% endif %}>
                음력 (Lunar Calendar)
            </label>
        </div>

        <div id="age-info" style="padding: 0.5rem 0; color: var(--text-muted); font-size: 0.9em; display: none;"></div>

        {% if page in ['ai_saju', 'tojeong', 'byeoljari'] %}
        <button type="submit"
            style="width: 100%; padding: 1rem; background: var(--gold-gradient); border: none; border-radius: 8px; color: var(--bg-dark); font-weight: bold; cursor: pointer; font-size: 1rem;">
            결과보기
        </button>
        {% else %}
        <button type="button" disabled
            style="width: 100%; padding: 1rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: var(--text-muted); font-weight: bold; cursor: not-allowed; font-size: 1rem;">
            결과보기
        </button>
        {% endif %}
    </form>

    <div id="form-error"
        style="margin-top: 1rem; padding: 0.75rem; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; color: #FCA5A5; display: none;">
    </div>

    <!-- API Key 입력 필드 -->
    <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid rgba(255,255,255,0.1);">
    <div style="margin-bottom: 1rem;">
        <label style="display: block; margin-bottom: 0.5rem; color: #A0AEC0; font-size: 0.85em;">OpenAI API Key
            (선택사항)</label>
        <input type="password" id="api-key-input" placeholder="sk-proj-..."
            style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-gold); border-radius: 8px; background: var(--navy-glass); color: var(--text-primary); font-size: 0.9em;">
        <div style="margin-top: 0.5rem; font-size: 0.8em; color: #A0AEC0;">
            <a href="https://platform.openai.com/api-keys" target="_blank"
                style="color: var(--gold-primary); text-decoration: none;">API Key 발급받기</a>
        </div>
        <div id="api-key-info"
            style="margin-top: 0.5rem; padding: 0.75rem; background: rgba(212,175,55,0.1); border: 1px solid rgba(212,175,55,0.3); border-radius: 8px; font-size: 0.85em; color: #F9E79F;">
            💡 API Key를 입력하시면 더 상세한 AI 분석을 받으실 수 있습니다.
        </div>
        <div id="api-key-status" style="margin-top: 0.5rem; font-size: 0.8em; display: none;"></div>
    </div>
</div>